@{
	Layout = null;
}
@model EAD_project.TblUser
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MessHub - My Profile</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="~/css/useprofile.css">
</head>
<body>

    <div class="dashboard-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h3><i class="bi bi-egg-fried me-2"></i>MessHub</h3>
            </div>
            <nav class="sidebar-nav">
                <a href="user-dashboard.html" class="nav-link"><i class="bi bi-grid-1x2-fill"></i> My Dashboard</a>
                <a href="user-attendance.html" class="nav-link"><i class="bi bi-calendar-check-fill"></i> My Attendance</a>
                <a href="menu.html" class="nav-link"><i class="bi bi-journal-text"></i> Menu</a>
                <a href="user-bills.html" class="nav-link"><i class="bi bi-receipt"></i> My Bills</a>
                <a href="user-disputes.html" class="nav-link"><i class="bi bi-exclamation-triangle-fill"></i> My Disputes</a>
                <a href="user-profile.html" class="nav-link active"><i class="bi bi-person-circle"></i> Profile</a>
            </nav>
            <div class="sidebar-footer">
                <a href="login.html" class="nav-link"><i class="bi bi-box-arrow-left"></i> Logout</a>
            </div>
        </aside>

        <!-- Sidebar Overlay for Mobile -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Navbar -->
            <header class="top-navbar">
                <button class="btn sidebar-toggle d-lg-none" id="sidebarToggle">
                    <i class="bi bi-list"></i>
                </button>
                <h4 class="page-title">My Profile</h4>
                <div class="navbar-right">
                    <span class="user-greeting">Welcome, <strong id="navUserName">Ahmed Ali</strong></span>
                    <div class="user-avatar">
                        <i class="bi bi-person-circle"></i>
                    </div>
                </div>
            </header>

            <!-- Profile Content -->
            <div class="dashboard-content">
                <div class="row g-4">
                    <!-- Profile Card -->
                    <div class="col-12 col-lg-4">
                        <div class="card profile-card">
                            <div class="profile-header">
                                <div class="profile-avatar">
                                    <i class="bi bi-person-fill"></i>
                                </div>
                                <h4 id="profileName">Ahmed Ali</h4>
                                <p class="profile-username"><span id="profileUsername">ahmed.ali</span></p>
                                <span class="badge bg-success">Active Member</span>
                            </div>
                            <div class="profile-body">
                                <div class="profile-info-item">
                                    <i class="bi bi-envelope-fill text-primary"></i>
                                    <div>
                                        <label>Email</label>
                                        <p id="profileEmail">ahmed.ali@example.com</p>
                                    </div>
                                </div>
                                <div class="profile-info-item">
                                    <i class="bi bi-building text-success"></i>
                                    <div>
                                        <label>Department</label>
                                        <p id="profileDepartment">Computer Science</p>
                                    </div>
                                </div>
                                <div class="profile-info-item">
                                    <i class="bi bi-credit-card-fill text-warning"></i>
                                    <div>
                                        <label>CNIC</label>
                                        <p id="profileCnic">12345-6789012-3</p>
                                    </div>
                                </div>
                                <div class="profile-info-item">
                                    <i class="bi bi-telephone-fill text-info"></i>
                                    <div>
                                        <label>Phone</label>
                                        <p id="profilePhone">0300-1234567</p>
                                    </div>
                                </div>
                                <div class="profile-info-item">
                                    <i class="bi bi-calendar-event-fill text-danger"></i>
                                    <div>
                                        <label>Member Since</label>
                                        <p id="profileJoinDate">January 2025</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Change Password Card -->
                    <div class="col-12 col-lg-8">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-shield-lock-fill me-2"></i>Change Password</h5>
                            </div>
                            <div class="card-body">
                                <div class="password-info-banner">
                                    <i class="bi bi-info-circle-fill"></i>
                                    <div>
                                        <strong>Password Requirements</strong>
                                        <p>Your password must be at least 8 characters long and include uppercase, lowercase, number, and special character.</p>
                                    </div>
                                </div>

                                <form id="changePasswordForm" class="password-form">
                                    <!-- Current Password -->
                                    <div class="mb-4">
                                        <label for="currentPassword" class="form-label">
                                            <i class="bi bi-key-fill me-2"></i>Current Password
                                        </label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="currentPassword" placeholder="Enter your current password" required>
                                            <button class="btn btn-outline-secondary toggle-password" type="button" data-target="currentPassword">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                        </div>
                                        <div class="invalid-feedback" id="currentPasswordError"></div>
                                    </div>

                                    <!-- New Password -->
                                    <div class="mb-4">
                                        <label for="newPassword" class="form-label">
                                            <i class="bi bi-lock-fill me-2"></i>New Password
                                        </label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="newPassword" placeholder="Enter your new password" required>
                                            <button class="btn btn-outline-secondary toggle-password" type="button" data-target="newPassword">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                        </div>
                                        <div class="invalid-feedback" id="newPasswordError"></div>
                                        
                                        <!-- Password Strength Indicator -->
                                        <div class="password-strength mt-2">
                                            <div class="strength-bar">
                                                <div class="strength-fill" id="strengthFill"></div>
                                            </div>
                                            <small class="strength-text" id="strengthText">Password Strength</small>
                                        </div>

                                        <!-- Password Requirements Checklist -->
                                        <div class="password-requirements mt-3">
                                            <div class="requirement" id="reqLength">
                                                <i class="bi bi-circle"></i>
                                                <span>At least 8 characters</span>
                                            </div>
                                            <div class="requirement" id="reqUppercase">
                                                <i class="bi bi-circle"></i>
                                                <span>One uppercase letter</span>
                                            </div>
                                            <div class="requirement" id="reqLowercase">
                                                <i class="bi bi-circle"></i>
                                                <span>One lowercase letter</span>
                                            </div>
                                            <div class="requirement" id="reqNumber">
                                                <i class="bi bi-circle"></i>
                                                <span>One number</span>
                                            </div>
                                            <div class="requirement" id="reqSpecial">
                                                <i class="bi bi-circle"></i>
                                                <span>One special character (!#$%^&*)</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Confirm New Password -->
                                    <div class="mb-4">
                                        <label for="confirmPassword" class="form-label">
                                            <i class="bi bi-lock-fill me-2"></i>Confirm New Password
                                        </label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" id="confirmPassword" placeholder="Confirm your new password" required>
                                            <button class="btn btn-outline-secondary toggle-password" type="button" data-target="confirmPassword">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                        </div>
                                        <div class="invalid-feedback" id="confirmPasswordError"></div>
                                        <div class="password-match mt-2" id="passwordMatch" style="display: none;">
                                            <i class="bi bi-check-circle-fill text-success"></i>
                                            <small class="text-success">Passwords match</small>
                                        </div>
                                    </div>

                                    <!-- Submit Button -->
                                    <div class="d-flex gap-3">
                                        <button type="submit" class="btn btn-success btn-change-password" id="changePasswordBtn">
                                            <i class="bi bi-check-circle me-2"></i>Update Password
                                        </button>
                                        <button type="reset" class="btn btn-outline-secondary">
                                            <i class="bi bi-x-circle me-2"></i>Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- Security Tips Card -->
                        <div class="card mt-4">
                            <div class="card-header">
                                <h5><i class="bi bi-shield-check me-2"></i>Security Tips</h5>
                            </div>
                            <div class="card-body">
                                <div class="security-tips">
                                    <div class="tip-item">
                                        <i class="bi bi-1-circle-fill text-success"></i>
                                        <div>
                                            <strong>Use a unique password</strong>
                                            <p>Don't reuse passwords from other accounts.</p>
                                        </div>
                                    </div>
                                    <div class="tip-item">
                                        <i class="bi bi-2-circle-fill text-success"></i>
                                        <div>
                                            <strong>Change password regularly</strong>
                                            <p>Update your password every 3-6 months.</p>
                                        </div>
                                    </div>
                                    <div class="tip-item">
                                        <i class="bi bi-3-circle-fill text-success"></i>
                                        <div>
                                            <strong>Never share your password</strong>
                                            <p>Keep your login credentials confidential.</p>
                                        </div>
                                    </div>
                                    <div class="tip-item">
                                        <i class="bi bi-4-circle-fill text-success"></i>
                                        <div>
                                            <strong>Log out on shared devices</strong>
                                            <p>Always sign out when using public computers.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Success Modal -->
    <div class="modal fade" id="successModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center py-5">
                    <div class="success-icon">
                        <i class="bi bi-check-circle-fill text-success"></i>
                    </div>
                    <h4 class="mt-4">Password Changed Successfully!</h4>
                    <p class="text-muted">Your password has been updated. Please use your new password for future logins.</p>
                    <button type="button" class="btn btn-success mt-3" data-bs-dismiss="modal">
                        <i class="bi bi-check me-2"></i>Got it!
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
<!-- Pass Backend Data to JavaScript -->
<script>
    window.serverUserProfile = {
        name: "@Model.Name",
        username: "@Model.Username",
        department: "@Model.Department",
        cnic: "@Model.Cnic",
        role: "@Model.Role",
        // Format Join Date if you have a created_at field, otherwise generic
        joinDate: "Active Member" 
    };
</script>

<script src="~/js/user-profile.js"></script>
    <script src="~/js/userprofile.js"></script>
</body>
</html>
